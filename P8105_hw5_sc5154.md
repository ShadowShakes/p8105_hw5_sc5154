P8105_hw5_sc5154
================
Shaohan Chen
2022-11-16

This is the solution of P8105 Data Science Homework5.

``` r
library(tidyverse)
```

## Problem 1

The goal of this problem is:

Create a tidy dataframe containing data from all participants, including
the subject ID, arm, and observations over time.  
Then we make a spaghetti plot showing observations on each subject over
time, and comment on differences between groups.

Let’s start with loading the dataset.

``` r
df_par = 
  tibble(
    file_name = list.files("./data_p1/"),
    file_path = str_c("./data_p1/", file_name)
   ) %>%
  mutate(data = map(file_path, read_csv)) %>%
  unnest()
## Warning: `cols` is now required when using unnest().
## Please use `cols = c(data)`
```

Then let’s tidy the dataset.

``` r
df_par = 
  df_par %>%
  mutate(
    file_name = str_remove(file_name, ".csv"),
  ) %>%
  separate(file_name, into = c("arm", "subject_id"), sep = "_") %>%
  pivot_longer(
    cols = week_1:week_8,
    names_to = "week",
    names_prefix = "week_",
    values_to = "observation"
  )
```

Let’s see how it looks like now

``` r
head(df_par, 5)
## # A tibble: 5 × 5
##   arm   subject_id file_path            week  observation
##   <chr> <chr>      <chr>                <chr>       <dbl>
## 1 con   01         ./data_p1/con_01.csv 1            0.2 
## 2 con   01         ./data_p1/con_01.csv 2           -1.31
## 3 con   01         ./data_p1/con_01.csv 3            0.66
## 4 con   01         ./data_p1/con_01.csv 4            1.96
## 5 con   01         ./data_p1/con_01.csv 5            0.23
```

Next, we make a spaghetti plot showing observations on each subject over
time, and comment on differences between groups.

``` r
df_par %>% 
  ggplot(aes(x = week, 
             y = observation, 
             group = subject_id, color = arm)) +
  geom_point() +
  geom_path() +
  facet_grid(. ~ arm) +
  labs(
    title = "Observations on each subject over time",
    x = "Week",
    y = "Observation"
  )
```

![](P8105_hw5_sc5154_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

So we make the plot. Here are some difference between groups: The
experimental arm and control arm have similar average observations level
at the beginning. As time goes by, the control arm keeps to be in the
same level as the initial stage, but the experimental arm increases
roughly linearly over time, and reaches a much higher level than the
control arm.

## Problem 2

We first import the dataset downloaded.

``` r
df_hom = 
  read_csv("data_p2/homicide-data.csv") 

head(df_hom, 5)
## # A tibble: 5 × 12
##   uid    repor…¹ victi…² victi…³ victi…⁴ victi…⁵ victi…⁶ city  state   lat   lon
##   <chr>    <dbl> <chr>   <chr>   <chr>   <chr>   <chr>   <chr> <chr> <dbl> <dbl>
## 1 Alb-0…  2.01e7 GARCIA  JUAN    Hispan… 78      Male    Albu… NM     35.1 -107.
## 2 Alb-0…  2.01e7 MONTOYA CAMERON Hispan… 17      Male    Albu… NM     35.1 -107.
## 3 Alb-0…  2.01e7 SATTER… VIVIANA White   15      Female  Albu… NM     35.1 -107.
## 4 Alb-0…  2.01e7 MENDIO… CARLOS  Hispan… 32      Male    Albu… NM     35.1 -107.
## 5 Alb-0…  2.01e7 MULA    VIVIAN  White   72      Female  Albu… NM     35.1 -107.
## # … with 1 more variable: disposition <chr>, and abbreviated variable names
## #   ¹​reported_date, ²​victim_last, ³​victim_first, ⁴​victim_race, ⁵​victim_age,
## #   ⁶​victim_sex
```

The raw data has 52179 rows and 12 columns. The variables are: uid,
reported_date, victim_last, victim_first, victim_race, victim_age,
victim_sex, city, state, lat, lon, disposition
